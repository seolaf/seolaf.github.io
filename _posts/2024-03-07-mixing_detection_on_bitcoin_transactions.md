---
title: ["[Research] - Mixing detection on bitcoin transactions using statistical patterns"]
date: 2024-03-07 09:00:00 +0900
last_modified_at: 2024-03-07 09:00:00 +0900
categories: [research, crypto]
tags: [research]
---

> Shojaeinasab, A., Motamed, A. P., & Bahrak, B. (2023). Mixing detection on bitcoin transactions using statistical patterns. IET Blockchain, 3(3), 136-148.

***
## 연구 개요
이 논문은 비트코인 믹싱 서비스를 탐지하고 추적하는 방법을 제안한다. 기존 연구는 **CoinJoin** 같은 전통적인 믹싱 기법을 연구했지만, 본 연구는 최신 **MixTum**, **Blender**, **CryptoMixer** 등의 현대적인 믹싱 서비스에 초점을 맞췄다. 저자들은 직접 믹싱 서비스를 이용하며 데이터를 수집했고, 이를 바탕으로 거래 패턴을 분석하여 탐지하는 알고리즘을 개발했다. 해당 알고리즘은 100%의 Recall을 달성했으며, 이는 믹싱 거래를 모두 탐지했음을 의미한다.

***
## 연구 방법론
### 데이터 수집
- 비트코인 풀노드 실행
- 직접 믹싱 서비스(MixTum, Blender, CryptoMixer) 이용 
- 믹싱된 거래 패턴 분석


### 탐지 알고리즘 개발
#### 1단계: Transaction-Level Pattern
믹싱된 거래에서 일반적인 특징을 발견  
- 1:2 structure
- P2SH 주소 활용
- 대부분 input이 1BTC 이상
- 2개의 output 중 하나가 다른 하나보다 5배 이상 많음.

> P2SH(Pay-to-Script-Hash)의 보안적 이점과 믹서에서의 역할  
> 다중서명 에스크로: P2SH는 다중서명 스크립트를 간편하게 사용하도록 함으로써, 여러명이 공동으로 자금을 관리할 수 있게 함. 믹서는 이를 활용해 운영자와 사용자 두 당사자가 모두 서명해야 출금이 가능한 2-of-2 다중 서명 주소를 만들 수 있음. 이를 통해 믹싱 과정의 신뢰도를 부여함.  
> 시간 지연 등 조건부 기능: P2SH 스크립트에는 CheckLockTimeVerify(CLTV)와 같은 시간 잠금 기능을 넣을 수 있어, 정해진 시간이 지난 후에야 일정 서명 없이도 출금이 가능하도록 설정할 수 있음. 믹서는 이를 응용하여 지연 출금이나 자동 환불 메커니즘을 구현함.  
> 스크립트 은닉: P2SH의 설계상 잠금 조건은 해시로만 드러나고 실제 내용은 지갑 주인만 알고 있기 때문에, 보안 측면에서 정보 노출을 최소화할 수 있음. 다중서명에 몇 명의 서명이 필요한지, 시간 잠금이 있는지 등의 정보는 블록체인에 즉시 드러나지 않고, 올바를 조건을 충족하여 소비될 때 밝혀짐.  

#### 2단계: Chain-Level Pattern
개별 트랜잭션이 아닌, 연결된 트랜잭션(체인)을 분석하여 탐지 정확도 향상  
**Sweeper Transactions**: 믹서에서 코인을 여러 주소에 흩뿌린 후, 이를 하나의 새로운 주소로 다시 모으는 과정  
트랜잭션 체인의 길이와 시간 패턴을 분석
- 믹서 트랜잭션 체인 길이 중앙값: 52
- 믹서 트랜잭션 체인 평균 시간 간격: 32분
- 거래소 트랜잭션 체인 길이 중앙값: 10
- 거래소 트랜잭션 체인 평균 시간 간격: 10분

***
## 실험 및 결과
### 실험 세부 사항
- 315,554개 트랜잭션을 대상으로 분석
- MixTum, Blender, CryptoMixer에서 각각 15개의 믹싱 트랜잭션을 생성하여 패턴 분석
- Precision 100%, Recall 100% 달성

***
## 한계점
- 믹싱 서비스가 새로운 패턴을 도입할 경우 탐지 우회 가능
- 라벨링된 데이터 부족의 문제
- Real World 데이터와 괴리가 있을 수 있음.

***
## 비판적 리뷰
1. 재현한 믹싱 데이터와 리얼 월드의 믹싱 데이터가 일치하는지 검증하는 과정이 부족
   - 더 많은 믹싱 서비스의 데이터를 포함하고, 다른 연구진이 검증할 수 있는 공개된 라벨링 데이터셋을 사용해야함.
2. 오탐과 미탐이 없다는게 현실적이지 않음.
   - 마찬가지로 데이터셋과 관련된 문제인데, 휴리스틱한 기준에 철저히 부합하는 데이터셋이 사용되었을 가능성이 매우 큼.
3. 알고리즘의 확장 가능성에 대한 연구가 부족함.
   - 30만개의 트랜잭션은 네트워크에서 지극히 일부에 불과함. 