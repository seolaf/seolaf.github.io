---
title: ["[Research] - LLMxCPG: Context-Aware Vulnerability Detection Through Code Property Graph-Guided Large Language Models"]
date: 2025-07-07 09:00:00 +0900
last_modified_at: 2025-07-07 09:00:00 +0900
categories: [research, llm, vulnerability detection]
tags: [research]
---

> Lekssays, A., Mouhcine, H., Tran, K., Yu, T., & Khalil, I. (2025). LLMxCPG: Context-Aware Vulnerability Detection Through Code Property Graph-Guided Large Language Models. arXiv preprint arXiv:2507.16585.

***
## 연구 개요
취약점 탐지의 정확성을 향상시키기 위해 CPG(Code Property Graph)와 LLM을 결합한 새로운 프레임워크를 제안함.

***
## 연구 방법론
### CPG 기반 접근법
LLMxCPG는 CPG를 이용한 정교한 코드 슬라이싱 기법을 도입하여 취약점과 관련된 간결한 코드 조각을 생성함.
1. Taint Path Extraction: Joern 도구와 CPGQL 쿼리 언어를 사용하여 취약할 가능성이 있는 실행 경로를 찾음.
2. Interacters Identifiacation: 이러한 실행 경로와 상호작용하는 변수를 찾음.
3. Backward Slicing: 취약점과 직접적으로 연관된 필수적인 코드 요소를 포함한 최적화된 코드 조각을 생성함.
   
### LLM과의 결합
두 가지 특화된 모델을 사용하여 각각의 작업을 수행함.
- LLMxCPG-Q: 정확환 CPGQL쿼리를 생성하여 취약점 관련 실행 경로를 분리함.
- LLMxCPG-D: 생성된 코드 조각을 취약함 또는 안전함으로 분류함.

이 모델들은 Qwen2.5-Coder와 QwQ-32B-Preview를 기반으로 하여, 강력한 특징 학습과 효과적인 취약점 탐지를 위한 미세조정을 거침.

***
## 데이터셋 및 실험 구성
- FormAI-v2: 다양한 LLM을 이용해 생성된 331,000개의 형식적으로 검증된 C 프로그램으로 구성된 데이터셋
- PrimeVul: 엄격히 검증된 데이터로 구성된 데이터셋으로, 140가지의 CWE 유형을 다룸.
- SVEN 및 ReposVul: 실제 환경의 데이터셋으로 일반화 성능을 평가하기 위해 사용됨.
  
***
## 실험 결과
### 성능
- 정확도 : FormAI 데이터셋에서 81.46%, PrimeVul 데이터셋에서 72.5% 달성함.
- F1 점수 : FormAI 데이터셋 기준 0.8075의 높은 점수를 기록함.

### 일반화 성능
모델은 학습되지 않은 데이터셋에서도 뛰어난 일반화 성능을 보임.
- SVEN 데이터셋에서 최신 기법 대비 20% 향상된 정확도를 기록함.
- 복잡도가 높은 ReposVul 데이터셋에서도 일관된 정확도(63.4%)를 유지하며 안정적인 성능을 입증함.

### 강건성
LLMxCPG는 식별자 변경, 문장 삽입, 코드 순서 변경 등 의미를 유지하는 코드 변형에서도 높은 탐지 성능을 유지하여, 기존 모델들이 코드 변경 시 성능이 저하되는 문제를 효과적으로 해결함.

***
## 한계점 및 향후 연구 방향
- 취약점 유형 한계: 동적 특성을 갖는 레이스 race condition과 같은 취약점은 CPG 기반 접근법으로 탐지가 어려움.
- 데이터 품질: 보다 높은 품질과 포괄성을 갖춘 데이터셋의 필요성이 있음.
- 프로젝트 수준의 복잡성: 함수 수준에서는 우수한 성능을 보였으나, 복잡한 프로젝트 수준의 취약점 탐지에서는 개선의 여지가 있음.

저자들은 향후 연구에서 데이터셋의 개선과 함께 추론 경로(reasoning trace)의 통합을 통해 모델의 해석 가능성과 성능을 더욱 향상할 계획임.


